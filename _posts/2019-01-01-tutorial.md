---
layout: post
title: 머신 러닝이란?
categories: [general, Machine_Learing]
tags: [Supervised, Unsupervised]
fullview: true
comments : true
---

### -머신 러닝
기존의 프로그램은 데이터를 처리하는데 결정 규칙을 수동으로 만들었다. 특정 분야나 작업에 대하여 'if' 와 'else' 를 가지고 논리적으로 처리하였지만, 이런 방식은 작업이 조금만 변형되어도 전체 시스템에 대한 결과가 달라질 수 있다는 문제점이 있다. 예시로, 요즘에는 쉽게 이루어지는 얼굴 인식의 경우 머신 러닝이라는 개념이 없었을 땐 매우 어려운 문제였다. 컴퓨터가 디지털 이미지를 인식하는 과정이 사람의 그것과 다르기에 정면에서 정확히 같은 포즈로 찍은 사진을 비교한다면 같다는 판정을 내릴 수 있겠지만, 각도가 달라지거나 표정이 다른 사진이라면 컴퓨터는 그것이 얼굴인지 판별하기 매우 어려워지기 때문이다. 

그러나 머신 러닝은 데이터를 이용하여 컴퓨터를 학습하는 방법론이다. 카네기 멜론 대학의 톰 미첼 교수는 머신 러닝을 이렇게 정의하였다.
*** 만약 컴퓨터 프로그램이 특정한 태스크 T를 수행할 때 성능 P 만큼 개선되는 경험 E를 보이면 그 컴퓨터 프로그램은 태스크와 성능 P에 대해 경험 E를 학습했다라고 할 수 있다. ***
특정한 테스크 T, 이미지 인식, 을 수행할 때 이미지를 인식할 확률 P가 계속 개선되며 얼굴을 인식할 때 필요한 특성 E에 대한 경험을 많은 얼굴 이미지를 제공해줌으로써 얻을 수 있는 컴퓨터는 얼굴을 특정하는 요인에 대해 학습할 수 있으며, 이는 오늘날 스마트폰으로도 다양한 각도에서 쉽게 얼굴을 인식할 수 있는 어플리케이션을 가능케 하는 것이다.

이러한 머신 러닝 알고리즘 중 2가지, 지도 학습(Supervised Learning), 비지도 학습(Unsupervised Learning)에 대하여이야기하도록 하겠다 .


<img src="{{ site.BASE_PATH }}/assets/ico/Image.jpg">
          
### -지도 학습
가장 많이 사용되는 머신 러닝 알고리즘들은 이미 알려진 사례를 바탕으로 모델을 일반화하여 의사 결정 프로세스를 자동화하는 것들이다. 이를 지도 학습이라고 하는데, 이미 존재하는 입력과 출력 데이터에 대하여 규칙을 학습하고, 이를 활용하여 새로운 입력에 대한 출력을 예측하는 것이다.

여기서 가장 중요한 부분은, 데이터에 대한 레이블(Label, 데이터에 대한 명시적인 답)이 있어야 한다는 것이다. 예를 들어, 고양이와 강아지를 구별하는 머신 러닝을 만들기 위해선 고양이와 강아지 이미지에 사람이 직접 이것이 고양이인지 강아지인지에 대한 정답을 정리해놓은, 데이터에 대한 레이블이 필요하다. 
만약 지도 학습의 여러 알고리즘을 사용하여 훈련 데이터로 학습한 모델이 새로운 데이터에 대해서도 정확히 예측할 수 있다면 이를 일반화(Generalization)되었다고 한다. 대부분의 지도 학습 알고리즘을 설계할 때, 데이터에 대해 가능한 정확하게 일반화가 되도록 하는 것이 주 목적이 된다.
그러나 지도 학습은 일반화가 항상 잘 이루어지지 않는다. 경우에 따라, 아주 복잡한 모델이 되어 특정 상황에만 치우쳐진 모델이 되거나, 아주 간단한 모델로 여러 특성을 잡아내는데 실패할 수 있다.

예를 들자면, 어떠한 사업가가 요트에 대하여 마케팅을 하려고 할 때, 요트 구매 데이터에 대하여 10명의 상담 고객 데이터를 보유하고 있다 하자. 이 데이터에 나이, 보유 차량, 주택 보유 여부, 혼인 상태와 요트 구매 여부가 있다면, 이를 기반으로 새로운 고객이 요트를 구매할 것인가에 대한 예측을 할 수 있다. 그러나 이 예측에 대한 문제가 생길 수 있다. 

만약 주택 보유 여부만이 예측에 영향을 끼치더라도, 주어진 정보를 모두 사용하여 예측하기에 너무 복잡한 모델을 만들어, 정확도가 떨어질 수 있다. 실제로는 주택을 보유한 사람이 요트를 구매하는것과 가장 밀접하게 관계가 있지만, 나이가 많고 자녀가 없는 사람이며 결혼하지 않은 사람이 요트를 구매할 가능성이 높으며, 집이 없을 수록 가능성은 더 높다는 결론이 나온다면 실제론 보유 주택이 없더라도 예측 모델은 요트를 구매할 것이다, 라고 판단해버리는 것이다. 너무 많은 정보를 사용하기에 그 정보에만 맞춰져, 새로운 예측에 대한 정확도가 떨어지는 것을 과대적합, Overfitting 이라고 한다.

반대로, 정보가 너무 없어서 간단한 모델을 만드는 것 또한 주의해야할 문제다. 실제로 되게 복잡한 변수가 요트를 구매할 때 적용하지만 데이터 모델은 간단하게 주택을 보유한 사람만 요트를 구매할 것이다 라고 판정을 내리게 된다면 다양성을 잡아내지 못하고, 매우 낮은 정확도를 보일 것이다. 이는 과소적합, Underfitting이라고 한다.

데이터 모델을 설계할 때, 과대적합과 과소적합 사이에, 최적의 성능을 갖고 있는 모델을 찾는것이 주요한 과제이다.

<img src="{{ site.BASE_PATH }}/assets/ico/Image2.png">


지도 학습을 두가지로 나눌 수 있다. 
분류(Classification)는 데이터에 대한 예측 값이 미리 정의된 범주 중 하나로 예측하는 것이다. 예를 들어 데이터에 대한 예측 값이 "강아지, 고양이" 중 하나로 나올 경우, 이것은 분류 알고리즘이라고 할 수 있다.
회귀(Regression)는 연속적인 숫자를 예측하는 것이다. 다음 주 주식이 얼마나 오를지에 대하여 2750원 더 오를 것이다, 같은 경우가 회귀 알고리즘이다.

지도 학습으로 사용되는 알고리즘에는 선형 모델, 나이브 베이즈 예측 모델이나 SVM, 결정 트리등이 있으며 더 나아가 딥 러닝으로는 Convolutional Neural Network나 REcurrent Neural Network 등이 있다.


### -비지도 학습

비지도 학습에서는 알고리즘에 입력은 주어지지만 출력은 주어지지 않는다. 이 알고리즘은 오직 입력 데이터만으로 데이터에서 지식을 추출할 수 있어야 한다. 
사실, 비지도 학습에서 가장 어려운 부분은 알고리즘이 사용하는 데이터에 대한 정답이 없기 때문에, 이 과정이 유의한가, 혹은 올바른가를 알아내는 일이다. 예를 들어 CCTV 데이터에서 도둑이 침입했는가 아닌가를 비지도 학습으로 분류하자고 한다면, 알고리즘은 무언가를 분류할 수 있지만 이것이 도둑이 침입한 이벤트를 분류한것인지 손님이 온건지를 알아내려면 사람이 직접 확인하는 것 밖에 방법이 없을 경우가 많다. 
이러한 이유로 비지도 학습은 데이터에 대하여 이해하고 어떻게 다룰지 고민하는 탐색적 분석 단계에서 이용하거나, 다른 머신 러닝 알고리즘이 원래 데이터보다 더 쉽게 해석할 수 있도록 만드는 데이터 전처리 단계에서 사용한다(물론 Generative Adversarial Network 구조도 훌륭한 성능을 보이고 있지만 이건 나중에..)
이러한 비지도 학습에는 다양한 종류가 있지만, 이해를 위해 대표적인 두 가지, 변환과 군집을 소개하겠다.

비지도 변환(Unsupervised Transform) 이란 데이터를 압축하고 추가적인 처리를 위해 정보가 잘 드러나는 표현을 찾기 위해 사용되는 변환이다. 주로 데이터 전체를 설명하는데 중요한 특성 일부만 선택하는 방법이 쓰인다.

<img src="{{ site.BASE_PATH }}/assets/ico/Image3.png">


위 사진처럼, 3차원의 데이터 중 주요한 부분을 추출, 2차원으로 변환하여 더 직관적으로 분류할 수 있게 만들어주는 방식이다. (위 사진은 매니폴드 학습이지만, 이것도 나중에...)

차원 축소나 특성 추출에 사용되는 주성분 분석(Principal component Analysis)나 비음수 행렬 분해(Non-negative matrix funciton), 시각화를 위한 t-SNE( t-distributed Stochastic neighbor embedding) 알고리즘 등 이 사용된다.
<img src="{{ site.BASE_PATH }}/assets/ico/Image4.png">


 
군집 알고리즘은 데이터를 비슷한 것 끼리 그룹으로 묶는 것이다. 
페이스북의 예를 들자면, 인물 사진을 올렸을 때 사람을 인식한다. 그러나 실제로 어떤 값을 주기 전 까진 인식된 얼굴이 누군지 모른다. 단지 업로드 된 프로필의 사진들에 나타난  얼굴 데이터들을 추출하여 같은 얼굴일거라 생각되는 데이터들끼리 그룹지어 인식하게 되는데, 이런 방식으로 실제 프로필 사진에 자신의 얼굴이 노출된다면 성공적인 군집이 이루어졌다고 볼 수 있는 것이다.
조금 더 구체적으로, 군집은 데이터셋을 클러스터라는 그룹으로 나누는 작업이다. 한 클러스터 안의 데이터 포인트들은 서로 매우 비슷한 특징을 갖고 있으며, 다른 클러스터와의 데이터 포인트와는 확실히 구분되도록 데이터를 나누는 것이 목표이며, 이를 통해 분류 알고리즘과 유사하게 어떤 클러스터에 데이터가 속하는지 예측이 가능하다.

군집 알고리즘으로는 kNN, DBSCAN, 계층적 군집 등이 있다.


### -강화 학습

강화 학습이란 위에 설명한 지도, 비지도 학습과는 조금 다른 형식을 갖고 있다. 

강화학습은 스스로가 학습하는 데이터 모델이 선택한 행동에 대하여, 환경을 인지하고 원하는 환경과의 차이에 대한 피드백을 통해 어떤 행동이 좋은 행동인지를 간접적으로 학습해나가며 최적의 행동을 할 수 있도록 학습하는 것을 의미한다. 

이 개념은 머신 러닝만의 개념이 아니라, 스키너의  행동 심리학에서 처음 등장했다. 
<img src="{{ site.BASE_PATH }}/assets/ico/Image5.png">

스키너의 상자로 유명한 이 실험은 쥐를 레버가 두 개 있는 상자에 가둬놓는것에서 시작한다. 한 쪽 레버는 누를 때 마다 먹이가 나오고, 한 쪽 레버는 누를 때 전기 충격을 가하도록 설정되어 있다면 쥐는 보상을 주는 레버를 당기도록 학습한다는 것이다. 쥐는 때떄론 전기 충격을 받으며 올바르지 못한 행동에 대한 규제를 받고, 올바른 행동에 대하여 먹이라는 보상을 받음으로 특정한 레버만 당기도록 학습할 것이다.

강화 학습 또한 이런 개념과 동일하다. 원하는 결과, 예를 들어 테트리스를 잘 할 수 있는 강화학습을 만들고자 한다면 게임을 진행시키고 내리는 선택에 따라, 여러번 게임 오버를 당해보기도 하고 점수를 따기도 하면서 올바른 선택에 대한 학습이 진행될 것이다.

 앞서 지도 학습과 비지도 학습이 정적인 상태의 알고리즘이었다면, 강화 학습은 최고의 결과를 낼 수 있도록 학습하는것과 더불어 동적인 환경에서 데이터를 수집하는 과정까지 포함되어 있다.


 
